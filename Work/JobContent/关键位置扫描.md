# 关键位置扫描

## 1. linux 系统架构

<img src="source/images/%E5%85%B3%E9%94%AE%E4%BD%8D%E7%BD%AE%E6%89%AB%E6%8F%8F/eed5a6713e374f68b4ff57c728b3da72.png" alt="linux系统架构" style="zoom: 50%;" />

**特点**：

1. 用户之间隔离
2. 内核态与用户态之间隔离
3. 用户进程一般以低权限用户运行
4. 系统服务一般以特权服务运行
5. 用户态通过系统调用进入内核态
6. 内核对系统资源进行管理和分配



## 2. Linux系统常见安全威胁

### 2.1 远端网络攻击

- **用户仿冒攻击**：通过伪造用户ID，暴力破解用户密码，登录系统提供的网络服务；
- **网络DOS攻击**：被远程用户进行拒绝服务攻击，如SYN Flood攻击；
- **网络服务/进程攻击**：对外开放了网络端口的业务进程存在缺陷可被远端攻击。



### 2.2 本地进程攻击

- **业务进程被攻击**：攻击者利用业务进程的缺陷进行攻击，导致正常业务进程无法正常工作；

  > 内存扫描：/proc/%d/

- **内核被攻击**：内核运行在特权态，攻击者利用内核漏洞进行攻击，从而提权；

  > 内核与驱动：/proc/modules、/lib/modules

- **系统服务被攻击**：系统服务一般运行在高权限，攻击者利用系统服务的缺陷进行提权，从而对系统进行更大的破坏，如获取系统关键信息，篡改系统文件。

  > 定时任务：/crontab

### 2.3 近端物理攻击

- **镜像篡改攻击**：设备加载的固件被替换或篡改，导致运行恶意系统；
- **物理端口被攻击**：利用系统的串口等物理端口进行攻击，绕过登录或导致系统无法正常工作，或泄露系统关键信息。



## 3. 攻击的常用步骤

![image-20250217140616877](source/images/%E5%85%B3%E9%94%AE%E4%BD%8D%E7%BD%AE%E6%89%AB%E6%8F%8F/image-20250217140616877.png)

- **踩点**：信息搜集、端口扫描

- **扫描**：漏洞扫描、利用已知漏洞、不安全配置，弱密码/口令

- **攻击**：暴力破解、定向挖掘目标的未知漏洞

- **提权**：利用系统弱点进行提权

  > 近期修改的文件、高权限属性的文件

- **消除日志**：篡改日志，隐藏踪迹

  > 敏感日志：`/var/log/`

- **植入后门**：植入木马，持续控制



## 4. 关键位置扫描

在 **Ubuntu** 或其他 Linux 系统上，杀毒软件在执行快速扫描/查杀时，除了内存扫描和定时任务扫描外，还会优先扫描以下关键位置来确保尽早发现潜在的恶意软件。以下是基于 Linux 系统的常见关键位置：

1. 内存：/proc
2. 定时任务与启动项：/crontab
3. 系统配置文件: /etc
4. **SUID/SGID文件**：扫描具有高权限属性的文件（如`find / -perm -4000`），防止恶意提权
5. **内核模块与驱动**：检查`/lib/modules/`下非官方或可疑内核模块（Rootkit常见载体）。
6. **敏感日志文件**：检查`/var/log/`下的日志完整性，如`lastlog`、`wtmp`，排查异常登录记录
7. **最近修改的文件**：根据时间戳快速定位近期被修改的文件（如`find / -mtime -1`）

优先级：**内存进程** → 2. **定时任务/启动项** → 3. **系统配置与SUID文件** → 4. **内核模块/Web目录** → 5. **日志与用户文件** → 6. **全盘扫描**（低优先级文件）。

